<!DOCTYPE html>
<head>
    <meta charset = "utf-8">
    <style>
        /* sets the style of the title Meeting Analysis */
        h1 {
            font-size: 50px;
            color: navy;
            font-family: HelvNeueLightForIBM, Helvetica Neue, Arial, Helvetica, sans-serif;
            text-align: left;
        }

        body {
            background-color: white;
        }

    </style>
    <title>Visualization</title>
</head>
<body>
    <h1>Meeting Analysis</h1>
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script>
        // arbitrarily sets width, height, and diameter
        var width = 770;
        var height = 940;
        var diameter = 760;

        // controls the number of nodes
        // will read from Json file
        var numParticipants = 6;

        // array of circles
        var circleData = [];
        var angle = 0;
        var x = 0;
        var y = 0;
        var alpha = ["A", "B", "C", "D", "E", "F", "G", "H", "I", "J", "K", "L", "M", "N", "O"];
        var colors = ["gainsboro", "lightgray", "silver", "darkgray", "gray", "dimgray", "lightslategray", "slategray", "darkslategray", "black"];

        // controls radius of circle the nodes are around
        var radius = 150;

        // creates container that the nodes are in with specific attributes
        var svgContainer = d3.select("body")
                            .append("svg")
                            .attr("width", 750)
                            .attr("height", 750)
                            .style("border", "1px solid black");

        // loops through for each participant and creates a node
        // and evenly spaces the nodes around the circle
        // in the future will use location data from Json to place people
        // also need to attach ID to each node
        for(var i = 0; i < numParticipants; i++) {
            // formula from here http://bl.ocks.org/bycoffe/3404776
            angle = (i / (numParticipants/2)) * Math.PI;
            x = (radius * Math.cos(angle)) + (width/2);
            y = (radius * Math.sin(angle)) + (width/2);

            var circle = svgContainer.append("circle")
                                .attr("cx", x)
                                .attr("cy", y)
                                .attr("r", 25)
                                .attr("id", alpha[i])
                                .style("stroke", "black")
                                .style("fill", colors[0]);
            
            circleData.push(circle);

            console.log(circleData[i].id);

            var text = svgContainer.append("text")
                                .attr("x", x)
                                .attr("y", y + 6)
                                .text(alpha[i])
                                .attr("font-family", "san-serif")
                                .attr("font-size", "20px")
                                .attr("fill", "black")
                                .attr("text-anchor", "middle");

            
        }

        var currentlySpeaking = true;
        var previouslySpoke = true;
        var currentRad = 40;
        
        currently(circleData);
        previously(circleData);
        timeSpoke(12, circleData);


        // function will be passed the id of the person currently speaking
        // and highlight them
        function currently(data) {
            if(currentlySpeaking) {
                data[3].style("stroke", "red")
                        .style("stroke-width", "10px");
            }
        }
        
        // function will be passed the id of the person who
        // just spoke and highlight them
        // will also darken the color of the circle by 1 shade
        function previously(data) {
            if(previouslySpoke) {
                data[2].style("stroke", "lightpink")
                        .style("stroke-width", "5px");
                data[2].style("fill", colors[5]);
            }
        }

        // function will be passed the amount of time someone spoke in seconds
        // and change the size of the node proportionally to the amount
        // of time
        // function will also be passed id of person who spoke
        function timeSpoke(time, data) {
            // currentRad = data[2].r;
            data[2].attr("r", (currentRad + (time * .25)));
        }
        
    </script>
    
</body>